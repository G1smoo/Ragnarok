import"../chunks/DsnmJJEf.js";import{p as ya,f as l,d as X,s as r,c as t,t as x,a as o,b as Pa,r as a,n as N,g as n,h as na}from"../chunks/BV3VnAY7.js";import{d as Ta,s as b}from"../chunks/CLeL-Gr1.js";import{i as S}from"../chunks/DVTYKMIZ.js";import{e as K,i as L}from"../chunks/LJCc-4DW.js";import{a as Y,e as Z}from"../chunks/tTaZ9371.js";import{s as oa,r as la,a as da}from"../chunks/CsT_n9Hh.js";import{b as ja}from"../chunks/B4OLx-bc.js";var Ia=l('<span class="badge badge-neutral"> </span>'),Sa=l('<th class="text-center whitespace-nowrap"> </th>'),Da=l('<span class="badge badge-success badge-sm gap-1"> </span>'),Ca=l('<span class="badge badge-warning badge-sm gap-1"> </span>'),Oa=l('<span class="text-base-content/20">—</span>'),Ma=l('<td class="text-center"><!></td>'),Ha=l('<tr><td class="font-medium whitespace-nowrap"> </td><!></tr>'),Va=l('<div class="card bg-base-100 shadow"><div class="card-body p-4"><h2 class="text-lg font-semibold mb-2">Oversigt</h2> <div class="overflow-x-auto"><table class="table table-sm"><thead><tr><th class="min-w-32">Hold</th><!></tr></thead><tbody></tbody></table></div> <div class="flex gap-4 mt-3 text-xs text-base-content/60"><span><span class="badge badge-warning badge-xs mr-1">⏳</span>Tjekket ind</span> <span><span class="badge badge-success badge-xs mr-1">✓</span>Færdig</span> <span><span class="opacity-30">—</span> Ikke besøgt</span></div></div></div>'),Aa=l('<div role="alert" class="alert alert-info"><span>Ingen hold fundet. <a href="/dashboard/teams" class="link">Opret hold</a> for at komme i gang.</span></div>'),Ka=l('<li class="flex items-center gap-3"><span class="text-sm font-mono w-5 text-base-content/40 shrink-0"></span> <a class="flex-1 text-sm font-medium truncate hover:underline"> </a> <span class="text-xs text-base-content/40 shrink-0"> </span> <span class="badge badge-neutral font-mono shrink-0"> </span></li>'),La=l('<li class="flex items-center gap-3"><span class="text-sm font-mono w-5 text-base-content/40 shrink-0"></span> <span class="flex-1 text-sm font-medium truncate"> </span> <span class="text-xs text-base-content/40 shrink-0"> </span> <span class="badge badge-neutral font-mono shrink-0"> </span></li>'),qa=l('<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="card bg-base-100 shadow"><div class="card-body p-4"><h2 class="text-lg font-semibold mb-3">Point — Hold</h2> <ol class="space-y-2"></ol></div></div> <div class="card bg-base-100 shadow"><div class="card-body p-4"><h2 class="text-lg font-semibold mb-3">Point — Poster</h2> <ol class="space-y-2"></ol></div></div></div>'),za=l('<div class="card bg-base-100 shadow"><div class="card-body text-center text-base-content/50">Ingen poster endnu. Tilføj den første post.</div></div>'),Ba=l('<p class="text-sm text-base-content/40 italic">Ingen hold her nu</p>'),Fa=l('<div class="flex items-center justify-between bg-warning/10 border border-warning/20 rounded-lg px-3 py-2"><div><p class="font-medium text-sm"> </p> <p class="text-xs text-base-content/50"> </p></div> <form method="POST" action="?/checkOut"><input type="hidden" name="checkInId"/> <button class="btn btn-xs btn-success">Ud ✓</button></form></div>'),Na=l('<div class="space-y-2"></div>'),Ra=l("<option> </option>"),Ua=l('<form method="POST" action="?/checkIn" class="flex gap-2 pt-1"><input type="hidden" name="post"/> <select name="team" class="select select-bordered select-xs flex-1 min-w-0"><option>Vælg hold...</option><!></select> <button class="btn btn-primary btn-xs whitespace-nowrap">Check ind</button></form>'),Ea=l('<p class="text-xs text-base-content/40 italic">Alle hold er tjekket ind</p>'),Ga=l('<div class="card bg-base-100 shadow"><div class="card-body p-4 space-y-3"><div class="flex items-center justify-between gap-2"><h3 class="font-semibold text-base"> </h3> <a class="btn btn-outline btn-xs gap-1" title="Åbn post-visning til mobil"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg> Post-visning</a></div> <!> <!></div></div>'),Ja=l('<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>'),Qa=l('<div role="alert" class="alert alert-error py-2"><span class="text-sm"> </span></div>'),Wa=l('<div class="m-3 mx-auto max-w-7xl space-y-6"><div class="flex flex-wrap items-center gap-3"><a href="/dashboard/runs" class="btn btn-ghost btn-sm">← Tilbage</a> <h1 class="text-2xl font-bold"> </h1> <!></div> <!> <!> <div class="flex items-center justify-between"><h2 class="text-xl font-semibold">Poster</h2> <button class="btn btn-primary btn-sm">+ Tilføj post</button></div> <!></div> <dialog class="modal"><div class="modal-box"><h3 class="font-bold text-lg mb-4">Tilføj post</h3> <form method="POST" action="?/addPost" class="space-y-3"><label class="form-control w-full"><div class="label"><span class="label-text">Post navn</span></div> <input type="text" name="name" class="input input-bordered" placeholder="Post 1" required/></label> <label class="form-control w-full"><div class="label"><span class="label-text">Rækkefølge (valgfrit)</span></div> <input type="number" name="order" class="input input-bordered" placeholder="1" min="0"/></label> <!> <div class="modal-action"><button type="button" class="btn">Annuller</button> <button type="submit" class="btn btn-primary">Tilføj</button></div></form></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog>',1);function rt(ia,v){ya(v,!0);let z;function R(e){return e?new Date(e).toLocaleTimeString("da-DK",{hour:"2-digit",minute:"2-digit"}):""}var $=Wa(),U=X($),E=t(U),G=r(t(E),2),va=t(G,!0);a(G);var ca=r(G,2);{var ma=e=>{var s=Ia(),p=t(s,!0);a(s),x(c=>b(p,c),[()=>new Date(v.data.run.date).toLocaleDateString("da-DK")]),o(e,s)};S(ca,e=>{v.data.run.date&&e(ma)})}a(E);var aa=r(E,2);{var ba=e=>{var s=Va(),p=t(s),c=r(t(p),2),u=t(c),P=t(u),D=t(P),M=r(t(D));K(M,17,()=>v.data.posts,L,(_,T)=>{var m=Sa(),h=t(m,!0);a(m),x(()=>b(h,n(T).name)),o(_,m)}),a(D),a(P);var H=r(P);K(H,21,()=>v.data.matrix,L,(_,T)=>{var m=Ha(),h=t(m),w=t(h,!0);a(h);var q=r(h);K(q,17,()=>n(T).cells,L,(j,d)=>{var i=Ma(),I=t(i);{var V=k=>{var f=Da(),O=t(f);a(f),x(y=>b(O,`✓ ${y??""}`),[()=>R(n(d).until)]),o(k,f)},C=k=>{var f=na(),O=X(f);{var y=g=>{var A=Ca(),F=t(A);a(A),x(ka=>b(F,`⏳ ${ka??""}`),[()=>R(n(d).since)]),o(g,A)},B=g=>{var A=Oa();o(g,A)};S(O,g=>{n(d).status==="checked_in"?g(y):g(B,!1)},!0)}o(k,f)};S(I,k=>{n(d).status==="checked_out"?k(V):k(C,!1)})}a(i),o(j,i)}),a(m),x(()=>b(w,n(T).team.team_name)),o(_,m)}),a(H),a(u),a(c),N(2),a(p),a(s),o(e,s)},pa=e=>{var s=na(),p=X(s);{var c=u=>{var P=Aa();o(u,P)};S(p,u=>{v.data.teams.length===0&&u(c)},!0)}o(e,s)};S(aa,e=>{v.data.posts.length>0&&v.data.teams.length>0?e(ba):e(pa,!1)})}var ta=r(aa,2);{var _a=e=>{var s=qa(),p=t(s),c=t(p),u=r(t(c),2);K(u,21,()=>v.data.teamScores,L,(H,_,T)=>{var m=Ka(),h=t(m);h.textContent=T+1;var w=r(h,2),q=t(w,!0);a(w);var j=r(w,2),d=t(j);a(j);var i=r(j,2),I=t(i);a(i),a(m),x(()=>{oa(w,"href",`/dashboard/teams/${n(_).id??""}`),b(q,n(_).name),b(d,`${n(_).postsVisited??""} poster`),b(I,`${n(_).total??""} pt`)}),o(H,m)}),a(u),a(c),a(p);var P=r(p,2),D=t(P),M=r(t(D),2);K(M,21,()=>v.data.postScores,L,(H,_,T)=>{var m=La(),h=t(m);h.textContent=T+1;var w=r(h,2),q=t(w,!0);a(w);var j=r(w,2),d=t(j);a(j);var i=r(j,2),I=t(i);a(i),a(m),x(()=>{b(q,n(_).name),b(d,`${n(_).teamsServed??""} hold`),b(I,`${n(_).total??""} pt`)}),o(H,m)}),a(M),a(D),a(P),a(s),o(e,s)};S(ta,e=>{(v.data.teamScores.some(s=>s.total>0)||v.data.postScores.some(s=>s.total>0))&&e(_a)})}var J=r(ta,2),fa=r(t(J),2);fa.__click=()=>z?.showModal(),a(J);var ua=r(J,2);{var ha=e=>{var s=za();o(e,s)},ga=e=>{var s=Ja();K(s,21,()=>v.data.postData,L,(p,c)=>{var u=Ga(),P=t(u),D=t(P),M=t(D),H=t(M,!0);a(M);var _=r(M,2);a(D);var T=r(D,2);{var m=d=>{var i=Ba();o(d,i)},h=d=>{var i=Na();K(i,21,()=>n(c).activeCheckIns,L,(I,V)=>{var C=Fa(),k=t(C),f=t(k),O=t(f,!0);a(f);var y=r(f,2),B=t(y);a(y),a(k);var g=r(k,2),A=t(g);la(A),N(2),a(g),Y(g,F=>Z?.(F)),a(C),x(F=>{b(O,n(V).teamName),b(B,`Ind kl. ${F??""}`),da(A,n(V).id)},[()=>R(n(V).checked_in)]),o(I,C)}),a(i),o(d,i)};S(T,d=>{n(c).activeCheckIns.length===0?d(m):d(h,!1)})}var w=r(T,2);{var q=d=>{var i=Ua(),I=t(i);la(I);var V=r(I,2),C=t(V);C.value=C.__value="";var k=r(C);K(k,17,()=>n(c).availableTeams,L,(f,O)=>{var y=Ra(),B=t(y,!0);a(y);var g={};x(()=>{b(B,n(O).team_name),g!==(g=n(O).id)&&(y.value=(y.__value=n(O).id)??"")}),o(f,y)}),a(V),N(2),a(i),Y(i,f=>Z?.(f)),x(()=>da(I,n(c).id)),o(d,i)},j=d=>{var i=Ea();o(d,i)};S(w,d=>{n(c).availableTeams.length>0?d(q):d(j,!1)})}a(P),a(u),x(()=>{b(H,n(c).name),oa(_,"href",`/dashboard/runs/${v.data.run.id??""}/posts/${n(c).id??""}`)}),o(p,u)}),a(s),o(e,s)};S(ua,e=>{v.data.postData.length===0?e(ha):e(ga,!1)})}a(U);var Q=r(U,2),ea=t(Q),W=r(t(ea),2),sa=r(t(W),4);{var xa=e=>{var s=Qa(),p=t(s),c=t(p,!0);a(p),a(s),x(()=>b(c,v.form.message)),o(e,s)};S(sa,e=>{v.form?.error&&v.form?.action==="addPost"&&e(xa)})}var ra=r(sa,2),wa=t(ra);wa.__click=()=>z?.close(),N(2),a(ra),a(W),Y(W,(e,s)=>Z?.(e,s),()=>()=>async({result:e,update:s})=>{await s(),e.type==="success"&&z?.close()}),a(ea),N(2),a(Q),ja(Q,e=>z=e,()=>z),x(()=>b(va,v.data.run.name)),o(ia,$),Pa()}Ta(["click"]);export{rt as component};
